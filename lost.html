<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Barang Hilang - GBK Lost & Found</title>
  <style>/* CSS sama seperti sebelumnya */</style>
</head>
<body>
  <!-- HTML FORM sama + tambah DATE field -->
  <!-- ... header, form fields ... -->
  
  <!-- TAMBAH DATE FIELD ini setelah GPS location: -->
  <div class="form-group">
    <label class="form-label">Tanggal Kehilangan <span class="required">*</span></label>
    <input type="datetime-local" class="form-input" id="lostDateTime" required>
  </div>
  
  <!-- Success message dengan BACK button: -->
  <div class="success-message" id="successMessage">
    <div class="success-icon">âœ…</div>
    <h2 style="color: var(--color-success);">Berhasil Disimpan!</h2>
    <p>Data terkirim ke tim GBK. Akan redirect ke home...</p>
    <button type="button" class="submit-button" onclick="window.location.href='https://sayawni.github.io/gbk-lost-found/'" style="background: #10b981; margin-top: 12px;">ğŸ  Kembali ke Home</button>
  </div>

  <script>
    // Helper function
    function getValue(id) {
      const el = document.getElementById(id);
      return el ? el.value : '';
    }

    // Form submit + DATE + REDIRECT
    form.addEventListener('submit', function(e) {
      e.preventDefault();
      submitBtn.disabled = true;
      submitBtn.textContent = 'Mengirim...';

      const formData = {
        timestamp: new Date().toISOString(),
        formType: 'LOST',
        name: getValue('name'),
        phone: getValue('phone'),
        idNumber: getValue('idNumber'),
        itemType: getValue('itemType'),
        description: getValue('description'),
        lastLocation: getValue('lastLocation'),
        dateTime: getValue('lostDateTime'),  // DATE BARU!
        latitude: getValue('latitude'),
        longitude: getValue('longitude'),
        photoUploaded: document.getElementById('itemPhoto').files.length > 0 ? 'Ya' : 'Tidak'
      };

      const params = new URLSearchParams(formData);
      const scriptURL = 'https://script.google.com/macros/s/AKfycbzAb5NYVc3HF8ozmX6OA_wIwd-nJlz2JR7_-g-DIX9vxdXqRNPpZxtIbYKjTQv0mNU/exec';

      fetch(`${scriptURL}?${params}`, { method: 'GET' })
        .then(response => response.text())
        .then(data => {
          if (data.includes('SUCCESS')) {
            form.style.display = 'none';
            successMessage.classList.add('active');
            // AUTO REDIRECT 3 detik
            setTimeout(() => {
              window.location.href = 'https://sayawni.github.io/gbk-lost-found/';
            }, 3000);
          } else {
            throw new Error(data);
          }
        })
        .catch(error => {
          submitBtn.disabled = false;
          submitBtn.textContent = 'Kirim Laporan';
          showError('Gagal: ' + error);
        });
    });
  </script>
</body>
</html>
